<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FC AI Chatbot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            height: 100vh;
            height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 0;
        }

        .chat-container {
            width: 90%;
            max-width: 800px;
            height: 90vh;
            height: 90dvh;
            background: rgba(47, 47, 47, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid rgba(64, 224, 158, 0.2);
        }

        .chat-header {
            background: linear-gradient(135deg, #2f2f2f 0%, #40e09e 100%);
            padding: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .chat-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .chat-header h1 {
            color: white;
            font-size: clamp(20px, 4vw, 28px);
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #40e09e;
            border-radius: 50%;
            margin-left: 10px;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px rgba(64, 224, 158, 0.7);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 15px;
            background: #2f2f2f;
            position: relative;
            -webkit-overflow-scrolling: touch;
        }

        .chat-messages::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to bottom, rgba(47, 47, 47, 1), transparent);
            z-index: 1;
            pointer-events: none;
        }

        .message {
            margin-bottom: 16px;
            display: flex;
            align-items: flex-start;
            animation: slideIn 0.3s ease-out;
            gap: 10px;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 75%;
            padding: 14px 18px;
            border-radius: 18px;
            position: relative;
            word-wrap: break-word;
            word-break: break-word;
            line-height: 1.6;
            font-size: clamp(14px, 3.5vw, 16px);
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #40e09e, #2d9e6b);
            color: white;
            border-bottom-right-radius: 5px;
            box-shadow: 0 4px 15px rgba(64, 224, 158, 0.3);
        }

        .message.bot .message-content {
            background: rgba(64, 64, 64, 0.8);
            color: #e5e7eb;
            border: 1px solid rgba(64, 224, 158, 0.2);
            border-bottom-left-radius: 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* Enhanced formatting for bot responses */
        .message.bot .message-content h1,
        .message.bot .message-content h2,
        .message.bot .message-content h3 {
            color: #40e09e;
            margin: 12px 0 8px 0;
            font-weight: 600;
        }

        .message.bot .message-content h1 {
            font-size: 1.4em;
            border-bottom: 2px solid #40e09e;
            padding-bottom: 5px;
        }

        .message.bot .message-content h2 {
            font-size: 1.2em;
        }

        .message.bot .message-content h3 {
            font-size: 1.1em;
        }

        .message.bot .message-content p {
            margin: 8px 0;
            line-height: 1.7;
        }

        .message.bot .message-content ul,
        .message.bot .message-content ol {
            margin: 10px 0 10px 20px;
            padding-left: 0;
        }

        .message.bot .message-content li {
            margin: 6px 0;
            line-height: 1.6;
            position: relative;
        }

        .message.bot .message-content ul li::before {
            content: 'â€¢';
            color: #40e09e;
            font-size: 1.2em;
            position: absolute;
            left: -15px;
        }

        .message.bot .message-content ol li {
            counter-increment: list-counter;
        }

        .message.bot .message-content ol {
            counter-reset: list-counter;
        }

        .message.bot .message-content ol li::before {
            content: counter(list-counter) '.';
            color: #40e09e;
            font-weight: 600;
            position: absolute;
            left: -20px;
        }

        .message.bot .message-content strong {
            color: #40e09e;
            font-weight: 600;
        }

        .message.bot .message-content em {
            color: #b8bcc8;
            font-style: italic;
        }

        .message.bot .message-content code {
            background: rgba(40, 40, 40, 0.8);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #40e09e;
            border: 1px solid rgba(64, 224, 158, 0.2);
        }

        .message.bot .message-content pre {
            background: rgba(40, 40, 40, 0.8);
            padding: 12px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 10px 0;
            border: 1px solid rgba(64, 224, 158, 0.2);
            font-family: 'Courier New', monospace;
        }

        .message.bot .message-content pre code {
            background: none;
            padding: 0;
            border: none;
            border-radius: 0;
        }

        .message.bot .message-content blockquote {
            border-left: 3px solid #40e09e;
            padding-left: 15px;
            margin: 10px 0;
            font-style: italic;
            color: #b8bcc8;
            background: rgba(64, 224, 158, 0.05);
            padding: 10px 15px;
            border-radius: 0 8px 8px 0;
        }

        .message.bot .message-content hr {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, #40e09e, transparent);
            margin: 15px 0;
        }

        .message.bot .message-content table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px 0;
            font-size: 0.9em;
        }

        .message.bot .message-content th,
        .message.bot .message-content td {
            border: 1px solid rgba(64, 224, 158, 0.3);
            padding: 8px;
            text-align: left;
        }

        .message.bot .message-content th {
            background: rgba(64, 224, 158, 0.1);
            color: #40e09e;
            font-weight: 600;
        }

        .avatar {
            width: clamp(32px, 8vw, 40px);
            height: clamp(32px, 8vw, 40px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: clamp(12px, 3.5vw, 16px);
            flex-shrink: 0;
        }

        .message.user .avatar {
            background: linear-gradient(135deg, #40e09e, #2d9e6b);
            color: white;
            order: 1;
        }

        .message.bot .avatar {
            background: linear-gradient(135deg, #2f2f2f, #404040);
            color: #40e09e;
            border: 2px solid #40e09e;
        }

        .typing-indicator {
            display: none;
            padding: 12px 16px;
            background: rgba(64, 64, 64, 0.8);
            border-radius: 18px;
            border-bottom-left-radius: 5px;
            max-width: 75%;
            border: 1px solid rgba(64, 224, 158, 0.2);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #40e09e;
            border-radius: 50%;
            animation: typing 1.5s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        .chat-input {
            padding: 16px;
            background: rgba(47, 47, 47, 0.9);
            border-top: 1px solid rgba(64, 224, 158, 0.2);
            position: relative;
            flex-shrink: 0;
            padding-bottom: max(16px, env(safe-area-inset-bottom));
        }

        .input-container {
            display: flex;
            gap: 10px;
            align-items: flex-end;
            position: relative;
        }

        .input-field {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid rgba(64, 224, 158, 0.3);
            border-radius: 20px;
            font-size: clamp(14px, 4vw, 16px);
            outline: none;
            resize: none;
            min-height: 44px;
            max-height: 100px;
            transition: all 0.3s ease;
            background: rgba(64, 64, 64, 0.8);
            color: #e5e7eb;
            line-height: 1.4;
            -webkit-appearance: none;
        }

        .input-field:focus {
            border-color: #40e09e;
            background: rgba(64, 64, 64, 1);
            box-shadow: 0 0 0 3px rgba(64, 224, 158, 0.1);
            transform: translateY(-1px);
        }

        .input-field::placeholder {
            color: #9ca3af;
        }

        .send-button {
            width: clamp(44px, 12vw, 50px);
            height: clamp(44px, 12vw, 50px);
            background: linear-gradient(135deg, #40e09e, #2d9e6b);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: clamp(14px, 4vw, 18px);
            box-shadow: 0 4px 15px rgba(64, 224, 158, 0.3);
            min-width: 44px;
            min-height: 44px;
        }

        .send-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(64, 224, 158, 0.4);
        }

        .send-button:active:not(:disabled) {
            transform: translateY(0);
        }

        .send-button:disabled {
            background: #6b7280;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .welcome-message {
            text-align: center;
            color: #9ca3af;
            margin: 30px 0;
            font-size: clamp(14px, 4vw, 18px);
            padding: 0 10px;
        }

        .welcome-message .emoji {
            font-size: clamp(36px, 10vw, 48px);
            display: block;
            margin-bottom: 15px;
        }

        .error-message {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            padding: 12px 16px;
            border-radius: 10px;
            margin: 10px 15px;
            text-align: center;
            animation: shake 0.5s ease-in-out;
            border: 1px solid rgba(239, 68, 68, 0.3);
            font-size: clamp(12px, 3.5vw, 14px);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .chat-messages::-webkit-scrollbar {
            width: 4px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #40e09e;
            border-radius: 10px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #2d9e6b;
        }

        /* Mobile specific styles */
        @media (max-width: 768px) {
            body {
                padding: 0;
            }
            
            .chat-container {
                width: 100%;
                height: 100vh;
                height: 100dvh;
                border-radius: 0;
                max-width: none;
            }

            .message-content {
                max-width: 85%;
            }

            .chat-messages {
                padding: 12px;
            }

            .chat-header {
                padding: 16px;
            }

            .chat-input {
                padding: 12px;
                padding-bottom: max(12px, env(safe-area-inset-bottom));
            }

            .input-container {
                gap: 8px;
            }
        }

        @media (max-width: 480px) {
            .message-content {
                max-width: 90%;
                padding: 10px 14px;
            }

            .avatar {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }

            .message {
                gap: 6px;
            }
        }

        @media (max-height: 500px) and (orientation: landscape) {
            .chat-header {
                padding: 12px;
            }

            .chat-header h1 {
                font-size: 20px;
            }

            .chat-messages {
                padding: 10px;
            }

            .welcome-message {
                margin: 20px 0;
            }

            .welcome-message .emoji {
                font-size: 32px;
            }
        }

        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .avatar {
                border-width: 1px;
            }
        }

        @media (prefers-color-scheme: dark) {
            body {
                background: #0a0a0a;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .chat-header::before {
                animation: none;
            }
            
            .status-indicator {
                animation: none;
            }
            
            .typing-dot {
                animation: none;
            }
            
            .message {
                animation: none;
            }
            
            .error-message {
                animation: none;
            }
            
            * {
                transition: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h1>FC AI Chatbot<span class="status-indicator"></span></h1>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="welcome-message">
                <span class="emoji">ðŸ¤–</span>
                <div>Hello! I'm your Gemini AI assistant.<br>Ask me anything to get started!</div>
            </div>
        </div>
        
        <div class="chat-input">
            <div class="input-container">
                <textarea 
                    id="messageInput" 
                    class="input-field" 
                    placeholder="Type your message here..."
                    rows="1"
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="sentences"
                    spellcheck="true"
                ></textarea>
                <button id="sendButton" class="send-button" type="button">
                    <span>âž¤</span>
                </button>
            </div>
        </div>
    </div>
    
    <script>
        const API_KEY = "AIzaSyBIG665dP-J-sJOMpvf-avnEbiHJ7ZQKPo";
        
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        
        let isLoading = false;
        
        // Auto-resize textarea
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 100) + 'px';
        });
        
        // Handle touch events for better mobile experience
        let touchStartY = 0;
        let touchEndY = 0;
        
        messageInput.addEventListener('touchstart', function(e) {
            touchStartY = e.changedTouches[0].screenY;
        }, { passive: true });
        
        // Send message on Enter (but allow Shift+Enter for new lines)
        messageInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // Prevent form submission and zoom on double tap
        messageInput.addEventListener('touchend', function(e) {
            touchEndY = e.changedTouches[0].screenY;
            // Prevent zoom on double tap
            if (Math.abs(touchEndY - touchStartY) < 10) {
                e.preventDefault();
            }
        }, { passive: false });
        
        sendButton.addEventListener('click', sendMessage);
        sendButton.addEventListener('touchstart', function(e) {
            e.preventDefault(); // Prevent double-tap zoom
            sendMessage();
        }, { passive: false });
        
        function formatBotMessage(content) {
            // Convert markdown-like formatting to HTML
            let formatted = content;
            
            // Convert headings
            formatted = formatted.replace(/^### (.*$)/gm, '<h3>$1</h3>');
            formatted = formatted.replace(/^## (.*$)/gm, '<h2>$1</h2>');
            formatted = formatted.replace(/^# (.*$)/gm, '<h1>$1</h1>');
            
            // Convert bold text
            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            formatted = formatted.replace(/__(.*?)__/g, '<strong>$1</strong>');
            
            // Convert italic text
            formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>');
            formatted = formatted.replace(/_(.*?)_/g, '<em>$1</em>');
            
            // Convert inline code
            formatted = formatted.replace(/`([^`]+)`/g, '<code>$1</code>');
            
            // Convert code blocks
            formatted = formatted.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
            
            // Convert blockquotes
            formatted = formatted.replace(/^> (.*$)/gm, '<blockquote>$1</blockquote>');
            
            // Convert horizontal rules
            formatted = formatted.replace(/^---$/gm, '<hr>');
            
            // Convert unordered lists
            formatted = formatted.replace(/^[\*\-\+] (.*)$/gm, '<li>$1</li>');
            formatted = formatted.replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>');
            
            // Convert ordered lists
            formatted = formatted.replace(/^\d+\. (.*)$/gm, '<li>$1</li>');
            // Only replace with ol if it's a numbered list pattern
            if (formatted.includes('<li>') && /^\d+\./.test(content)) {
                formatted = formatted.replace(/(<li>.*<\/li>)/s, '<ol>$1</ol>');
            }
            
            // Convert line breaks to paragraphs
            const paragraphs = formatted.split(/\n\s*\n/);
            formatted = paragraphs.map(p => {
                // Don't wrap if already contains HTML tags
                if (/<[^>]+>/.test(p)) {
                    return p;
                }
                return p.trim() ? `<p>${p.trim()}</p>` : '';
            }).filter(p => p).join('');
            
            return formatted;
        }
        
        function addMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            avatar.textContent = isUser ? 'U' : 'G';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            
            if (isUser) {
                messageContent.textContent = content;
            } else {
                // Format bot message with proper HTML structure
                messageContent.innerHTML = formatBotMessage(content);
            }
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }
        
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot';
            typingDiv.id = 'typing-indicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            avatar.textContent = 'G';
            
            const typingContent = document.createElement('div');
            typingContent.className = 'typing-indicator';
            typingContent.style.display = 'block';
            typingContent.innerHTML = `
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(typingContent);
            
            chatMessages.appendChild(typingDiv);
            scrollToBottom();
        }
        
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            chatMessages.appendChild(errorDiv);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
            
            scrollToBottom();
        }
        
        function scrollToBottom() {
            requestAnimationFrame(() => {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            });
        }
        
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message || isLoading) return;
            
            // Check for exit commands
            if (['exit', 'quit', 'bye'].includes(message.toLowerCase())) {
                addMessage('Goodbye! Thanks for chatting with me. ðŸ‘‹', false);
                return;
            }
            
            // Add user message
            addMessage(message, true);
            messageInput.value = '';
            messageInput.style.height = 'auto';
            
            // Set loading state
            isLoading = true;
            sendButton.disabled = true;
            showTypingIndicator();
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `Please provide a well-structured, clear, and organized response to: "${message}". Use proper formatting with headings, bullet points, numbered lists, and clear paragraphs where appropriate to make the information easy to understand and follow. Format your response similar to how ChatGPT structures its answers with clear sections and proper organization.`
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 2048,
                        }
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                hideTypingIndicator();
                
                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    const botResponse = data.candidates[0].content.parts[0].text;
                    addMessage(botResponse, false);
                } else {
                    throw new Error('Invalid response format from API');
                }
                
            } catch (error) {
                console.error('Error:', error);
                hideTypingIndicator();
                showError('Sorry, I encountered an error. Please try again.');
            } finally {
                isLoading = false;
                sendButton.disabled = false;
                messageInput.focus();
            }
        }
        
        // Prevent viewport scaling on iOS
        let viewportMeta = document.querySelector('meta[name="viewport"]');
        if (!viewportMeta) {
            viewportMeta = document.createElement('meta');
            viewportMeta.name = 'viewport';
            document.head.appendChild(viewportMeta);
        }
        viewportMeta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
        
        // Handle orientation changes
        window.addEventListener('orientationchange', function() {
            setTimeout(() => {
                scrollToBottom();
            }, 100);
        });
        
        // Handle viewport changes (keyboard open/close on mobile)
        window.addEventListener('resize', function() {
            setTimeout(() => {
                scrollToBottom();
            }, 100);
        });
        
        // Focus on input when page loads
        window.addEventListener('load', () => {
            setTimeout(() => {
                messageInput.focus();
            }, 100);
        });
        
        // Prevent zoom on input focus for iOS
        if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
            messageInput.addEventListener('focus', function() {
                setTimeout(() => {
                    window.scrollTo(0, 0);
                    document.body.scrollTop = 0;
                }, 100);
            });
        }
    </script>
</body>
</html>